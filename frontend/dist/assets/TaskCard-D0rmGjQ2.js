import{a as e,u as s,b as r}from"./vendor-query-CC2jgEBg.js";import{h as a,t,i as l,c as o}from"./index-BW9YzSHm.js";import{r as n,j as i}from"./vendor-react-DUoQhEpM.js";import{C as c,i as d,l as g,f as u,j as m,U as x,g as b,E as h,e as p}from"./vendor-icons-KwL3JnsX.js";import{f}from"./vendor-date-B0vwdYvA.js";const y="tasks";function j(s){const r=void 0;return e({queryKey:[y,r],queryFn:async()=>{try{return(await t.list(r)).data}catch(e){throw l(e)&&a(e,"Failed to fetch tasks"),e}},staleTime:3e3,refetchInterval:5e3})}function C(){const e=s();return r({mutationFn:async e=>{await t.cancel(e)},onSuccess:(s,r)=>{e.invalidateQueries({queryKey:["task",r]}),e.invalidateQueries({queryKey:[y]})},onError:(e,s)=>{a(e,`Failed to cancel task ${s}`)}})}const k={critical:{color:"text-red-700",bgColor:"bg-red-100",borderColor:"border-red-200"},high:{color:"text-orange-700",bgColor:"bg-orange-100",borderColor:"border-orange-200"},medium:{color:"text-yellow-700",bgColor:"bg-yellow-100",borderColor:"border-yellow-200"},low:{color:"text-green-700",bgColor:"bg-green-100",borderColor:"border-green-200"}},N={pending:{icon:b,color:"text-gray-600",bgColor:"bg-gray-100",label:"Pending"},assigned:{icon:x,color:"text-blue-700",bgColor:"bg-blue-100",label:"Assigned"},running:{icon:m,color:"text-blue-700",bgColor:"bg-blue-100",label:"Running"},completed:{icon:u,color:"text-green-700",bgColor:"bg-green-100",label:"Completed"},failed:{icon:g,color:"text-red-700",bgColor:"bg-red-100",label:"Failed"},cancelled:{icon:d,color:"text-gray-600",bgColor:"bg-gray-100",label:"Cancelled"}},v=n.memo(function({task:e,onClick:s,onAssign:r,onCancel:a,selected:t=!1}){var l;const c=k[e.priority],d=N[e.status],u=d.icon,m=n.useMemo(()=>{try{return f(new Date(e.created_at),{addSuffix:!0})}catch{return"unknown"}},[e.created_at]),b=n.useCallback(r=>{"Enter"!==r.key&&" "!==r.key||(r.preventDefault(),null==s||s(e))},[s,e]),y="pending"===e.status||"assigned"===e.status;return i.jsxs("div",{role:"button",tabIndex:s?0:-1,onClick:()=>null==s?void 0:s(e),onKeyDown:b,"aria-label":`Task: ${e.title}, Status: ${d.label}, Priority: ${e.priority}`,className:o("p-4 rounded-lg border transition-all","hover:shadow-md hover:border-blue-300","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",t&&"ring-2 ring-blue-500 border-blue-500",s&&"cursor-pointer","bg-white"),children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:"font-medium text-gray-900 truncate",children:e.title}),e.description&&i.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:e.description})]}),i.jsx("div",{className:o("px-2 py-1 rounded-full text-xs font-medium shrink-0",c.bgColor,c.color),"aria-label":`Priority: ${e.priority}`,children:e.priority})]}),i.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("div",{className:o("flex items-center gap-1 px-2 py-1 rounded-full text-xs",d.bgColor,d.color),"aria-label":`Status: ${d.label}`,children:[i.jsx(u,{className:"h-3 w-3","aria-hidden":"true"}),i.jsx("span",{children:d.label})]}),i.jsx("span",{className:"text-xs text-gray-600",children:m})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[e.assigned_agent&&i.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[i.jsx(x,{className:"h-3 w-3","aria-hidden":"true"}),i.jsx("span",{className:"truncate max-w-[80px]",children:e.assigned_agent.name})]}),y&&i.jsx("button",{onClick:s=>{s.stopPropagation(),null==r||r(e)},"aria-label":`Assign or manage task: ${e.title}`,className:"p-1 hover:bg-gray-100 rounded transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1",children:i.jsx(h,{className:"h-4 w-4 text-gray-600","aria-hidden":"true"})}),("running"===e.status||"assigned"===e.status)&&a&&i.jsx("button",{onClick:s=>{s.stopPropagation(),null==a||a(e)},"aria-label":`Cancel task: ${e.title}`,className:"p-1 hover:bg-red-50 rounded transition-colors focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-1",children:i.jsx(g,{className:"h-4 w-4 text-red-600","aria-hidden":"true"})})]})]}),"failed"===e.status&&(null==(l=e.result)?void 0:l.error)&&i.jsxs("div",{className:"mt-2 p-2 bg-red-50 border border-red-100 rounded text-xs text-red-700 flex items-start gap-1",children:[i.jsx(p,{className:"h-3 w-3 shrink-0 mt-0.5","aria-hidden":"true"}),i.jsx("span",{className:"line-clamp-2",children:e.result.error.message})]})]})});v.displayName="TaskCard";const w=n.memo(function({tasks:e,onTaskClick:s,onTaskAssign:r,onTaskCancel:a,selectedTaskId:t,columns:l=2}){return 0===e.length?i.jsxs("div",{className:"p-8 text-center text-gray-600",children:[i.jsx(c,{className:"mx-auto mb-2 h-12 w-12","aria-hidden":"true"}),i.jsx("p",{className:"text-lg",children:"No tasks found"}),i.jsx("p",{className:"text-sm",children:"Create a new task to get started"})]}):i.jsx("div",{className:o("grid gap-4",{1:"grid-cols-1",2:"grid-cols-1 md:grid-cols-2",3:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3",4:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"}[l]),role:"list","aria-label":"Task list",children:e.map(e=>i.jsx("div",{role:"listitem",children:i.jsx(v,{task:e,onClick:s,onAssign:r,onCancel:a,selected:t===e.id})},e.id))})});w.displayName="TaskGrid";export{w as T,C as a,j as u};
